#!/bin/bash


echo "Cleaning old logs"
echo " " > ./bob/console.log
echo " " > ./alice/console.log
echo " " > ./lily/console.log
echo " " > ./ross/console.log
echo " " > ./zach/console.log

./eth-private-net connect bob alice
./eth-private-net connect bob lily
./eth-private-net connect bob zach
./eth-private-net connect bob ross
./eth-private-net connect alice lily
./eth-private-net connect alice zach
./eth-private-net connect alice ross
./eth-private-net connect lily zach
./eth-private-net connect lily ross
./eth-private-net connect zach ross
./eth-private-net stopMiner ross
./eth-private-net stopMiner lily
./eth-private-net stopMiner alice
./eth-private-net stopMiner zach
./eth-private-net startMiner bob
./eth-private-net runTestScript alice aliceToLily.js &
./eth-private-net runTestScript zach zachToRoss.js &
./eth-private-net runTestScript ross rossToLily.js &

wait %1 %2 %3
./eth-private-net stopMiner ross
./eth-private-net stopMiner lily
./eth-private-net stopMiner alice
./eth-private-net stopMiner zach
# ./eth-private-net stopMiner bob
./eth-private-net runTestScript bob minerBlocksBob.js
./eth-private-net stopMiner bob

python3 logParser.py ./*/console.log
